# hajimu_engine_render

> **はじむ言語**向け SDL2 + OpenGL 3.3 Core Profile 2D レンダリングエンジン

スプライト・図形・テキスト描画、カメラ制御、キーボード/マウス入力を統合した  
オールインワン描画プラグインです。他の `hajimu_engine_*` シリーズのベースとなります。

---

## 機能

| カテゴリ | 内容 |
|---|---|
| ウィンドウ | 作成・更新・サイズ取得・タイミング |
| 入力 | キーボード / マウスボタン / 座標 |
| テクスチャ | PNG/JPG/BMP 読込・削除・サイズ取得 |
| スプライト | 通常描画 / 拡張 (回転・色) / UV 切り出し |
| 図形 | 矩形・円・直線 (アウトライン / 塗り潰し) |
| テキスト | TTF フォント読込 / デフォルトフォント / 描画・幅計算 |
| カメラ | 2D カメラ移動・ズーム・回転・リセット |
| ユーティリティ | 乱数 (float / 整数) |

## 依存ライブラリ

| ライブラリ | 用途 | 入手方法 |
|---|---|---|
| SDL2 | ウィンドウ / 入力 / GL コンテキスト | `brew install sdl2` |
| OpenGL 3.3 | GPU 描画 | macOS 標準 |
| stb_image | テクスチャ読込 | `make vendor` |
| stb_truetype | フォントレンダリング | `make vendor` |

## インストール

### 推奨: はじむパッケージマネージャー

```bash
hajimu パッケージ 追加 ReoShiozawa/hajimu_engine_render
```

### ソースからビルド

```bash
git clone https://github.com/ReoShiozawa/hajimu_engine_render.git
cd hajimu_engine_render

make vendor   # stb_image / stb_truetype をダウンロード
make          # → build/engine_render.hjp
make install  # → ~/.hajimu/plugins/engine_render/
```

## クイックスタート

```jp
プラグイン読込("engine_render")

ウィンドウ作成("はじむゲーム", 800, 600)
フォント = フォント読込デフォルト(24)
テックス = テクスチャ読込("player.png")

ループ{
    もし(ウィンドウ更新() == 偽){抜ける}
    もし(キー押下(キーコード("エスケープ"))){抜ける}

    描画クリア(0.1, 0.1, 0.2)
    スプライト描画(テックス, 100, 100, 64, 64)
    テキスト描画(フォント, "FPS: " + 文字列(FPS()), 10, 10)
    描画フラッシュ()
}

ウィンドウ削除()
```

## API リファレンス

### ライフサイクル

| 関数 | 引数 | 戻り値 | 説明 |
|---|---|---|---|
| `ウィンドウ作成(タイトル, 幅, 高さ)` | str, int, int | 0=成功/-1=失敗 | SDL2ウィンドウ+GLコンテキスト作成 |
| `ウィンドウ削除()` | — | null | 全リソース解放 |
| `ウィンドウ更新()` | — | bool | イベント処理。false で終了要求 |
| `ウィンドウ幅()` | — | int | ウィンドウ幅 (px) |
| `ウィンドウ高さ()` | — | int | ウィンドウ高さ (px) |
| `経過時間()` | — | float | 起動からの経過秒数 |
| `デルタ時間()` | — | float | 前フレームからの経過秒数 |
| `FPS()` | — | float | 現在の FPS |

### 入力

| 関数 | 引数 | 戻り値 | 説明 |
|---|---|---|---|
| `キーコード(名前)` | str | int | 日本語キー名→コード変換 |
| `キー押下中(コード)` | int | bool | キーを押し続けている間 true |
| `キー押下(コード)` | int | bool | そのフレームに押した瞬間 true |
| `キー離した(コード)` | int | bool | そのフレームに離した瞬間 true |
| `マウスX()` | — | float | マウスX座標 |
| `マウスY()` | — | float | マウスY座標 |
| `マウスボタン押下中(btn)` | int | bool | 1=左 2=中 3=右 |
| `マウスボタン押下(btn)` | int | bool | 押した瞬間 |

**キーコード名一覧**: `上` `下` `左` `右` `決定` `スペース` `エスケープ` `Z` `X` `C` `A` `S` `D` `W` `シフト` `コントロール` `F1`–`F12`

### テクスチャ

| 関数 | 引数 | 戻り値 | 説明 |
|---|---|---|---|
| `テクスチャ読込(パス)` | str | int | 0=失敗、それ以外=TexID |
| `テクスチャ削除(id)` | int | null | GPUメモリ解放 |
| `テクスチャ幅(id)` | int | int | 画像幅 |
| `テクスチャ高さ(id)` | int | int | 画像高さ |

### スプライト

| 関数 | 引数 | 説明 |
|---|---|---|
| `スプライト描画(id,x,y,w,h)` | — | 基本描画 |
| `スプライト描画拡張(id,x,y,w,h,rot,ox,oy,r,g,b,a)` | rot=度, ox/oy=0〜1 | 回転・色付き |
| `スプライト描画UV(id,x,y,w,h,u0,v0,u1,v1)` | uv=0〜1 | UV切り出し |

### 図形

| 関数 | 引数 | 説明 |
|---|---|---|
| `矩形描画(x,y,w,h,r,g,b,a)` | 色省略可 | アウトライン |
| `矩形塗潰(x,y,w,h,r,g,b,a)` | — | 塗り潰し |
| `円描画(cx,cy,r,r,g,b,a)` | — | アウトライン |
| `円塗潰(cx,cy,r,r,g,b,a)` | — | 塗り潰し |
| `直線描画(x1,y1,x2,y2,r,g,b,a)` | — | 線 |

### テキスト

| 関数 | 引数 | 戻り値 | 説明 |
|---|---|---|---|
| `フォント読込(パス, サイズ)` | str, float | int | TTF 読込 |
| `フォント読込デフォルト(サイズ)` | float=24 | int | システムフォント自動検出 |
| `フォント削除(id)` | int | null | 解放 |
| `テキスト描画(id, 文字列, x, y, r, g, b, a)` | 色省略可 | null | ASCII 描画 |
| `テキスト幅(id, 文字列)` | — | float | 幅計算 |

### カメラ

| 関数 | 引数 | 説明 |
|---|---|---|
| `カメラ位置設定(x, y)` | — | カメラ中心位置 |
| `カメラズーム設定(z)` | — | 1.0=等倍 |
| `カメラ回転設定(deg)` | — | 度数法 |
| `カメラリセット()` | — | デフォルトに戻す |
| `カメラX取得()` | — | 現在X |
| `カメラY取得()` | — | 現在Y |
| `カメラズーム取得()` | — | 現在ズーム |

### ユーティリティ

| 関数 | 戻り値 | 説明 |
|---|---|---|
| `乱数()` | float | 0.0〜1.0 |
| `乱数整数(最小, 最大)` | int | 範囲内の整数 |

## サンプル

- [examples/](examples/) — スプライト、タイル、カメラデモ

---

## ライセンス

MIT License — Copyright (c) 2026 Reo Shiozawa  
stb_image / stb_truetype: Public Domain — Copyright (c) Sean Barrett
